<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="UserDAO">
 	
	 <!-- 회원가입 -->
   <insert id="insert" parameterType="com.utf18.site.vo.UserVO">
      INSERT INTO USERS(EMAIL, PASSWORD, NICKNAME, BLACKLIST, OPERLIST, MANAGE_WARNCOUNT, APPLY, SUBSCRIBE) VALUES (#{email}, #{password}, #{nickname}, '', '', 3, 0, '')
                           <!-- 이메일 비번 닉네임 경고횟수 적용 -->
   </insert>

	<select id="getUserVO" resultType="com.utf18.site.vo.UserVO">
		SELECT * FROM USERS WHERE EMAIL = #{email}
	</select>
	
	<!--    아이디 중복 체크       -->
	<select id="idcheck" parameterType="String" resultType="int">
	   SELECT COUNT(*) FROM USERS WHERE EMAIL = #{email}
	</select>
	  
	<!--    닉네임 중복 체크       -->
	<select id="nicknamecheck" parameterType="String" resultType="int">
	   SELECT COUNT(*) FROM USERS WHERE NICKNAME = #{nickname}
	</select>
        
   <!--    비밀번호 일치하는지 체크       -->
   <select id="checkPassword" parameterType="String" resultType="String">
      SELECT PASSWORD FROM USERS WHERE EMAIL = #{email}
   </select>
   <!--    닉네임 가져오기 체크       -->
   <select id="getNickName" parameterType="java.lang.String" resultType="java.lang.String">
      SELECT NICKNAME FROM USERS WHERE EMAIL = #{email}
   </select>
   
   <!-- 사용자 지정 비속어 단어 추가 -->
   <insert id="addCustomBadword" parameterType="com.utf18.site.vo.CustomBadwordVO">
      INSERT INTO custom_badword VALUES(custom_badword_seq.NEXTVAL, #{content}, '0', #{email})
   </insert>

   <!-- 사용자 지정 비속어 단어 제거 -->
   <delete id="deleteCustomBadword" parameterType="com.utf18.site.vo.CustomBadwordVO">
      DELETE from custom_badword WHERE NUM = #{num}
   </delete>
   
   <!-- 사용자가 추가한 비속어 단어리스트 가져오기 -->
   <select id="getCustomBadWordList" parameterType="String" resultType="com.utf18.site.vo.CustomBadwordVO">
      SELECT num, content, email FROM custom_badword where EMAIL = #{email} ORDER BY num
   </select>
      <!-- 사용자 '경고횟수' 설정 -->
   <update id="setWarnCount" parameterType="com.utf18.site.vo.UserVO">
      UPDATE users SET manage_warncount = #{manage_warncount}
      WHERE EMAIL = #{email}
   </update>
   
   <select id ="limitWarnCount" parameterType="String" resultType="int">
		SELECT MANAGE_WARNCOUNT FROM USERS
		WHERE EMAIL = #{email}
   </select>
   
    <!-- 적용 0 => 유저가 작성한 비속어 리스트 채팅에 적용안함 -->
   <update id="apply0" parameterType="com.utf18.site.vo.UserVO">
      UPDATE users SET apply = '0' 
      WHERE EMAIL = #{email}
   </update>
   
   <!-- 적용 1 => 유저가 작성한 비속어 리스트 채팅에 적용 함 -->
   <update id="apply1" parameterType="com.utf18.site.vo.UserVO">
      UPDATE users SET apply = '1' 
      WHERE EMAIL = #{email}
   </update>
  
   <update id="subscribe" parameterType="com.utf18.site.vo.UserVO">
      UPDATE users SET SUBSCRIBE = #{subscribe} 
      WHERE EMAIL = #{email}
   </update>
   
   <select id="getApply" parameterType="String" resultType="String">
   SELECT APPLY FROM USERS WHERE EMAIL = #{email}
   </select>
   
  
</mapper>